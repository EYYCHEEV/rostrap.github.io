# Resources

[Resources](https://github.com/RoStrap/Resources/blob/master/Resources.lua) is the core resource manager and library loader for RoStrap. It is designed to streamline the retrieval and networking of resources and centralize the loading of libraries.

## Demo

It can be used to require your libraries:
```lua
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Resources = require(ReplicatedStorage:WaitForChild("Resources"))
local Date = Resources:LoadLibrary("Date")
print(Date())  --> Sat Dec 31 15:38:01 2022
```

It can be used to manage your RemoteEvents and RemoteFunctions:

```lua
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Resources = require(ReplicatedStorage:WaitForChild("Resources"))

local Chatted = Resources:GetRemoteEvent("Chatted")
local ClientLoaded = Resources:GetRemoteFunction("ClientLoaded")
```

![](https://user-images.githubusercontent.com/15217173/38775951-d6bfbeee-404b-11e8-8396-9666a0b20b98.png)

## Functionality
Upon being [required](http://wiki.roblox.com/index.php?title=Global_namespace/Roblox_namespace#require) on the server for the first time, [Resources](https://github.com/RoStrap/Resources/blob/master/Resources.lua) moves libraries within `ServerStorage.Repository` to folder `ReplicatedStorage.Resources.Libraries`, where both the client and server can [require](http://wiki.roblox.com/index.php?title=Global_namespace/Roblox_namespace#require) them via the function `LoadLibrary`.

![](https://image.prntscr.com/image/ZonjgCDFQLabru0xbMBUNQ.png)

!!! note ""
	* Only [Folders](http://wiki.roblox.com/index.php?title=API:Class/Folder) and libraries should go in this repository.
		* Folder heiarchy of libraries is ignored.
	* A [ModuleScript](http://wiki.roblox.com/index.php?title=API:Class/ModuleScript) and its descendants are considered a single library.
		* Thus, only parent [ModuleScripts](http://wiki.roblox.com/index.php?title=API:Class/ModuleScript) will be accessible via `LoadLibrary`
	* Anything within the Repository with "Server" (case-sensitive) in its name as well as its children will not be accessible to clients
		* This includes [Folders](http://wiki.roblox.com/index.php?title=API:Class/Folder), libraries, and descendants of libraries.
		* Server-only objects will be located within folder `ServerStorage.Resources`

!!! info
	Internally, `LoadLibrary` caches and returns `require(Resources:GetLibrary(LibraryName))`. `GetLibrary` is the only function that can "retrieve" objects from both `ServerStorage` and `ReplicatedStorage`. This is because server libraries are added directly to its cache.

<!-- !!! note
	Libraries will not be moved into `ReplicatedStorage` in Play-Solo (to allow for editing libraries during Play-Solo). -->

## API
All methods of [Resources](https://github.com/RoStrap/Resources/blob/master/Resources.lua) have hybrid syntax, meaning they can be called using either a `:` or `.`

### LoadLibrary

!!! summary "<span style="color:purple;">Variant</span> Resources:<span style="color:blue;">LoadLibrary</span>(<span style="color:green;">string</span> LibraryName)"

	A require-by-string function which internally calls `require(Resources:GetLibrary(string LibraryName))` and caches the results.


!!! example
	```lua
	local SortedArray = Resources:LoadLibrary("SortedArray")

	-- Some people like to overwrite the default require function
	local require = Resources.LoadLibrary

	local Signal = require("Signal")
	```

!!! info
	This is the only function with a hard-coded name for its cache, so you may access cached require results using the following:

	```lua
	-- Resources uses this table to cache LoadLibrary results
	local LoadedLibraries = Resources:GetLocalTable("LoadedLibraries")
	```

### Get functions

!!! summary "<span style="color:purple;">Ref&lt;Instance&gt;</span> Resources:<span style="color:blue;">GetCLASSNAME</span>(<span style="color:green;">string</span> InstanceName)"

	Get functions can be procedurally generated by [Resources](https://github.com/RoStrap/Resources/blob/master/Resources.lua) at run-time in the form of `Resources:GetCLASSNAME(string InstanceName)`. These functions return an [Instance](http://wiki.roblox.com/index.php?title=API:Class/Instance) named `InstanceName` under `Resources:GetFolder(CLASSNAME:gsub("y$", "ie") .. "s")`. On the server, missing instances will be instantiated via [Instance.new](http://wiki.roblox.com/index.php?title=Instance_(Data_Structure)). On the client, the function will yield for the missing instances via [WaitForChild](http://wiki.roblox.com/index.php?title=API:Class/Instance/WaitForChild).

	![](assets/images/Demonstration.png)


The following is the internal call tree. Keep in mind that these functions cache so the 3rd function will only run once per machine and `GetFolder` will only run once per function generation (e.g. the first time `GetRemoteEvent` is called).

|Step|Object to search for|Function call|
|:-:|:-:|:-:|
|1|RemoteEvent `Chatted` inside|GetRemoteEvent("Chatted")|
|2|Folder `RemoteEvents` in|GetFolder("RemoteEvents")|
|3|`Resources`|ROOT|

![](https://user-images.githubusercontent.com/15217173/38775951-d6bfbeee-404b-11e8-8396-9666a0b20b98.png)

!!! info
	* Caches results in `Resources:GetLocalTable(CLASSNAME:gsub("y$", "ie") .. "s")`

!!! example
	Get functions can also manage instance types that aren't instantiable by `Instance.new`. However, these instances must be preinstalled in the locations in which they would otherwise be instantiated because they cannot be generated at run-time. This allows you to do things like the following:

	```lua
	local Falchion = Resources:GetSword("Falchion")
	```

	![](https://user-images.githubusercontent.com/15217173/38775984-64af0b2e-404c-11e8-9279-0adace656665.png)

#### GetLocal functions

!!! summary "<span style="color:purple;">Ref&lt;Instance&gt;</span> Resources:<span style="color:blue;">GetLocalCLASSNAME</span>(<span style="color:green;">string</span> InstanceName)"

	Get functions in the form of `GetLocalCLASSNAME` work in the same way as regular Get functions, except clients may also instantiate missing instances and `GetLocalFolder` searches in different locations. Not meant to be used very much.

|**Machine**|LOCALSTORAGE|LOCALRESOURCES|
|:-----:|:----:|:----:|
|**Server**|`ServerStorage`|`ServerStorage.Resources`|
|**Client**|`Players.LocalPlayer.PlayerScripts`|`Players.LocalPlayer.PlayerScripts.Resources`|

|Step|Object to search for|Function call|
|:-:|:-:|:-:|
|1|BindableEvent `Attacking` inside|GetLocalBindableEvent("Attacking")|
|2|Folder `BindableEvents` in|GetLocalFolder("BindableEvents")|
|3|Folder `LOCALSTORAGE.Resources`|LOCALRESOURCES|

!!! example
	```lua
	local Attacking = Resources:GetLocalBindableEvent("Attacking")
	```

	Here is what the above code would do if ran by the server versus what it would do if ran by a client:

	|Server|Client|
	|:----:|:----:|
	|![](https://user-images.githubusercontent.com/15217173/38918583-6a9dcf50-42ab-11e8-8dbd-a165595af63f.png)|![](https://user-images.githubusercontent.com/15217173/38918817-00857d1a-42ac-11e8-9a3e-3176a2cb65b0.png)|


!!! warning
	In Play-Solo Mode, all local objects will go under `ServerStorage`, as there is no difference between the client and server. If you use identical Local-function calls on the client and server, this could cause conflicts in Play-Solo. The same problem applies to caches, which have "Local" appended to the front of the string to differentiate from regular caches. `LOCALSTORAGE` is typically just for `GetLocalBindableEvent` calls and having a place to store server-only Libraries, which are under `GetLocalFolder("Resources")`.

### GetLocalTable

!!! summary "<span style="color:purple;">table</span> Resources:<span style="color:blue;">GetLocalTable</span>(<span style="color:green;">string</span> TableName)"

	A function which caches a local table by string, and returns said table. Does not replicate. Useful for eliminating the need for [_G](http://wiki.roblox.com/index.php?title=Global_namespace/Basic_functions#G) or ModuleScripts which return an empty table.


!!! note
	Because this is hard-coded and not procedurally generated, it doesn't obey the rules of other GetLocal functions.

!!! example
	```lua
	-- Can be used in any script on the same machine to get this table
	local MyItems = Resources:GetLocalTable("MyItems") -- {}
	```

!!! info
	Resources uses `GetLocalTable` internally, so you can access its internals using this function:

	```lua
	-- Resources uses this table to cache LoadLibrary results
	local LoadedLibraries = Resources:GetLocalTable("LoadedLibraries")
	```

## RoStrap Discord

Questions? Comments? Concerns? Join us!

<div align="left">
	<a href="https://discord.gg/pjJw8s4">
		<img src="https://discordapp.com/assets/94db9c3c1eba8a38a1fcf4f223294185.png" alt="Discord" width=200 height=68 />
	</a>
</div>
